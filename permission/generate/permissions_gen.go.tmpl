// Code generated by github.com/cble-platform/cble-backend, DO NOT EDIT.

package permission

import (
	"context"

	"github.com/cble-platform/cble-backend/ent"
	"github.com/cble-platform/cble-backend/ent/grantedpermission"
	"github.com/cble-platform/cble-backend/permission/actions"
	"github.com/google/uuid"
)

var AllSubjectActions = map[grantedpermission.ObjectType][]actions.PermissionAction{
  {{- range $target, $actions := . }}
  grantedpermission.ObjectType{{- $target | Title -}}: {
    {{- range $actions }}
    actions.Action{{- $target | Title -}}{{- . | Title }},
    {{- end }}
  },
  {{- end }}
}

{{- range $target, $actions := . }}
// {{ $target | Title }} //

{{ range $actions }}
// Has{{- $target | Title -}}{{- . | Title -}} reports whether a given user has the "{{- $target | ToLower -}}_{{- . | ToLower -}}" permission. Use [github.com/google/uuid.Nil] to denote a wildcard object ID.
func Has{{- $target | Title -}}{{- . | Title -}}(ctx context.Context, client *ent.Client, entUser *ent.User, objectID uuid.UUID) (bool, error) {
	return HasPermission(
		ctx,
		client,
		entUser,
		grantedpermission.ObjectType{{- $target | Title -}},
		objectID,
		actions.Action{{- $target | Title -}}{{- . | Title -}},
	)
}

{{- end }}

{{ range $actions }}
// CurrentUserHas{{- $target | Title -}}{{- . | Title -}} reports whether the current user (pulled from context) has the "{{- $target | ToLower -}}_{{- . | ToLower -}}" permission. Use [github.com/google/uuid.Nil] to denote a wildcard object ID.
func CurrentUserHas{{- $target | Title -}}{{- . | Title -}}(ctx context.Context, client *ent.Client, objectID uuid.UUID) (bool, error) {
	return CurrentUserHasPermission(
		ctx,
		client,
		grantedpermission.ObjectType{{- $target | Title -}},
		objectID,
		actions.Action{{- $target | Title -}}{{- . | Title -}},
	)
}

{{- end }}
{{- end }}
